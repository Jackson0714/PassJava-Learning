## 说说 MySQL 的 redo log 和 binlog？

MySQL 整体来看，其实就有两块：

- Server 层，它主要做的是 MySQL 功能层面的事情。Server 层也有自己的日志，称为 binlog（归档日志）
- 引擎层，负责存储相关的具体事宜。redo log 是 InnoDB 引擎特有的日志。

redo log 是物理日志，记录的是“在某个数据页上做了什么修改”；binlog 是逻辑日志，记录的是这个语句的原始逻辑，比如“给 ID=2 这一行的 c 字段加 1 ”。

redo log 是循环写的，空间固定会用完；

binlog 是可以追加写入的。“追加写”是指 binlog 文件写到一定大小后会切换到下一个，并不会覆盖以前的日志。

## SQL 标准的事务隔离级别包括



读未提交（read uncommitted）是指，一个事务还没提交时，它做的变更就能被别的事务看到。

读提交（read committed）是指，一个事务提交之后，它做的变更才会被其他事务看到。

可重复读（repeatable read）是指，一个事务执行过程中看到的数据，总是跟这个事务在启动时看到的数据是一致的。当然在可重复读隔离级别下，未提交变更对其他事务也是不可见的。

串行化（serializable ），顾名思义是对于同一行记录，“写”会加“写锁”，“读”会加“读锁”。当出现读写锁冲突的时候，后访问的事务必须等前一个事务执行完成，才能继续执行。

![](http://cdn.jayh.club/blog/20210817/tzjUQG7BUMHA.png?imageslim)



首先先了解mysql主从同步的原理

1. master提交完事务后，写入binlog
2. slave连接到master，获取binlog
3. master创建dump线程，推送binglog到slave
4. slave启动一个IO线程读取同步过来的master的binlog，记录到relay log中继日志中
5. slave再开启一个sql线程读取relay log事件并在slave执行，完成同步
6. slave记录自己的binglog

![](https://tva1.sinaimg.cn/large/007S8ZIlgy1gidswpbazqj30ta0h277y.jpg)

由于mysql默认的复制方式是异步的，主库把日志发送给从库后不关心从库是否已经处理，这样会产生一个问题就是假设主库挂了，从库处理失败了，这时候从库升为主库后，日志就丢失了。由此产生两个概念。

**全同步复制**

主库写入binlog后强制同步日志到从库，所有的从库都执行完成后才返回给客户端，但是很显然这个方式的话性能会受到严重影响。

**半同步复制**

和全同步不同的是，半同步复制的逻辑是这样，从库写入日志成功后返回ACK确认给主库，主库收到至少一个从库的确认就认为写操作完成。



## 说说建立索引的优势、负面影响和原则？

（1）索引的优势？

检索速度：快速访问数据表中的特定信息，提高检索速度。

唯一性：创建唯一性索引，保证数据库表中每一行数据的唯一性。

加速连接：加速表和表之间的连接。

减少分组和排序的时间：使用分组和排序进行数据检索时，可以显著减少查询中分组和排序的时间。

（2）索引的负面影响？

耗时：创建索引和维护索引需要耗费时间，这个时间随着数据量的增加而增加。

占空间：索引需要占用物理空间，不光是表需要占用数据空间，每个索引也需要占用物理空间。

维护速度：当对表进行增、删、改、的时候索引也要动态维护，这样就降低了数据的维护速度。

（3）为数据表建立索引的原则有哪些？

在最频繁使用的、用以缩小查询范围的字段上建立索引。

在频繁使用的、需要排序的字段上建立索引。

（4）什么情况下不适合建立索引？

对于查询中很少涉及的列或者重复值比较多的列，不宜建立索引。

对于一些特殊的数据类型，不宜建立索引，比如文本字段（text）。

