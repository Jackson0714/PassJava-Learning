1面:

## volatile的底层原理是怎么做的,Reentrantlock公平锁和非公平锁有什么区别, 讲讲源码上的差别

## Reentrantlock和countDownLatch的区别,模式有什么不同,AQS是怎么加到队列的

## 给我写一个单利模式, 写了之后讲讲不加volatile会有什么问题. new对象非原子性的问题

## mysql的binlog,redolog,和undolog,都是做什么的,    undolog除了原子性涉及到,还有什么方面涉及用到

### **binlog**

binlog用于记录数据库执行的写入性操作(不包括查询)信息，以二进制的形式保存在磁盘中。binlog是mysql的逻辑日志，并且由Server层进行记录，使用任何存储引擎的mysql数据库都会记录binlog日志。

- 逻辑日志：可以简单理解为记录的就是sql语句。
- 物理日志：因为mysql数据最终是保存在数据页中的，物理日志记录的就是数据页变更。

binlog是通过追加的方式进行写入的，可以通过max_binlog_size参数设置每个binlog文件的大小，当文件大小达到给定值之后，会生成新的文件来保存日志。

### **binlog使用场景**

在实际应用中，binlog的主要使用场景有两个，分别是主从复制和数据恢复。

- 主从复制：在Master端开启binlog，然后将binlog发送到各个Slave端，Slave端重放binlog从而达到主从数据一致。
- 数据恢复：通过使用mysqlbinlog工具来恢复数据。

### **binlog刷盘时机**

对于InnoDB存储引擎而言，只有在事务提交时才会记录biglog，此时记录还在内存中，那么biglog是什么时候刷到磁盘中的呢？mysql通过sync_binlog参数控制biglog的刷盘时机，取值范围是0-N：

- 0：不去强制要求，由系统自行判断何时写入磁盘；
- 1：每次commit的时候都要将binlog写入磁盘；
- N：每N个事务，才会将binlog写入磁盘。



### redo log

redo log 采用循环写的方式记录，当写到结尾时，会回到开头循环写日志。

`redo log`适用于崩溃恢复(crash-safe)

`redo log`的大小是固定的。

## redolog和binglog的两阶段提交你知道吗?

通常我们说 MySQL 的“双 1”配置，指的就是 sync_binlog 和 innodb_flush_log_at_trx_commit 都设置成 1。也就是说，一个事务完整提交前，需要等待两次刷盘，一次是 redo log（prepare 阶段），一次是 binlog。

##  redolog是怎么刷盘到磁盘的 

InnoDB 有一个后台线程，每隔 1 秒，就会把 redo log buffer 中的日志，调用 write 写到文件系统的 page cache，然后调用 fsync 持久化到磁盘。

## mysql的索引一页有多大



## Redis的分布式锁是怎么用的,怎么解决缓存雪崩问题

## 分库分表你们怎么拆的

## JVM自己做了什么优化吗, 你了解不
我给他聊了逃逸分析 栈上分配 标量替换 锁消除, 内联,  栈帧优化



2面:
## 自我介绍一下自己, 上一家公司有没有做过什么高性能的接口开发, 有没有做过比较有成就的需求,讲解一下怎么做的
我讲的是一个千万级数据量同步的需求开发, 从并发MQ消费聊到代码优化, 聊到服务集群效果, 聊到sql的自增锁,唯一索引,插入缓存优化,还聊到了JVM内存不够触发的full gc怎么调整

## 看过哪些JDK源码吗,我讲的是AQS,给他聊聊源码+一些个人看法,主要是并发编程的优化力度问题

## Redis的分布式锁是怎么用的,ZK 和redis的实现讲了一下,

### Redis 分布式锁

抢占锁，同时设置超时时间，脚本解锁

### Zookeeper 分布式锁

举个栗子。对某一个数据连续发出两个修改操作，两台机器同时收到了请求，但是只能一台机

器先执行完另外一个机器再执行。那么此时就可以使用 zookeeper 分布式锁，一个机器接收到

了请求之后先获取 zookeeper 上的一把分布式锁，就是可以去创建一个 znode，接着执行操

作；然后另外一个机器也尝试去创建那个 znode，结果发现自己创建不了，因为被别人创建

了，那只能等着，等第一个机器执行完了自己再执行。

![](http://cdn.jayh.club/uPic/image-20220311074751393cKT2c3.png)

## redis看门狗怎么实现的

## 主从之后的redis锁丢失问题

1、异步数据丢失。

2、脑裂问题。

## 红锁怎么做的

假设有5个redis节点，这些节点之间既没有主从，也没有集群关系。客户端用相同的key和随机值在5个节点上请求锁，请求锁的超时时间应小于锁自动释放时间。当在3个（超过半数）redis上请求到锁的时候，才算是真正获取到了锁。如果没有获取到锁，则把部分已锁的redis释放掉。

## Redis删除大key是怎么删的，redis删除大key是异步 , 让你来做你怎么做，给讲讲你的实现思路

## Redis哨兵选举流程

## mysql索引的叶子节点的顺序指针 ,存的是什么玩意,  回表是怎么回事, 怎么避免回表,索引下推是什么,

## 给你一个Sting变量, 它的元素存在文件里面,怎么设计能让他快速的去这个文件里面获取找个元素值,

## explain执行计划讲讲.怎么用,mysql的优化器用的索引不是最优的,怎么办, 索引的一些组合索引的引用,维护之类的

## order By 一个组合索引, 会排序几次

## 看到你项目中有做过一个动态数据源是怎么做的

## RocketMQ底层原理结构怎么样的, 怎么解决的消息堆积,重复消费,消息丢失问题

## 做过接口优化吗, 怎么做的,怎么对一个接口做幂等性校验问题,数据库的唯一索引做幂等性校验有什么问题



3面:

## mysql中如果查询太多怎么办, 主从/多数据源

## 分库分表怎么做,怎么拆的,多大的时候适合拆,拆完之后的数据热点问题怎么处理

## redis热点key问题怎么解决的,  redis集群的节点本身的热点数据怎么解决

## 工作中有带过团队经验吗,有没有大团队互相合作的经验,遇到了什么问题,怎么解决的. 你怎么思考这些引发的问题.

## 为什么要离职,对未来的展望是怎么样的