# 实战缓存

思维导图目录

上一篇的讲到如何做性能调优的方法，比如给表加索引、动静分离、减少不必要的日志打印。但有一个很强大优化方式没有提到，那就是加缓存，比如查询小程序的广告位配置，因为没什么人会去频繁的改，将广告位配置丢到缓存里面再适合不过了。那我们就给开源项目 PassJava（佳必过）加下缓存来提升下性能。

在实战之前，我们先来看下使用缓存的原理和问题。

## 一、缓存

### 1.1 为什么要用缓存

20 年前常见的系统就是单机的，比如 ERP 系统，对性能要求不高，使用缓存的并不常见，但现如今，已经步入到互联网时代，高并发、高可用、高性能总是被提起，而缓存在这“三高”中立下汗马功劳。

我们通过会将部分数据放入缓存中，来提高访问速度，然后数据库承担存储的工作。

那么哪些数据适合放入缓存中呢？

- 即时性。例如查询最新的物流状态信息。

- 数据一致性要求不高。例如门店信息，修改后，数据库中已经改了，5 分钟后缓存中才是最新的，但不影响功能使用。
- 访问量大且更新频率不高。比如首页的广告信息，访问量，但是不会经常变化。

当我们想要查询数据时，使用缓存的流程如下：

![读模式缓存使用流程](http://cdn.jayh.club/uPic/image-20210412155243748.png)

### 1.2  本地缓存

最简单的使用缓存的方式就是用本地缓存。比如用一个 HashMap 存储题目的所有类型，HashMap 是在内存中的。

```java
private Map<String, Object> cache = new HashMap<>();
```

